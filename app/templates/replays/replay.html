{% extends "layout.html" %}

{% block content %}
    <div class="page-header">
        <h1>Replay <small>{{ replay.id }}</small></h1>
        {% include "replays/replay_nav.html" %}
    </div>


{#    state = db.Column(db.Enum(#}
{#        "WAITING_GC",#}
{#        "WAITING_DOWNLOAD",#}
{#        "DOWNLOAD_IN_PROGRESS",#}
{#        "WAITING_PARSE",#}
{#        "PARSE_IN_PROGRESS",#}
{#        "PARSED",#}
{#        "GC_ERROR",#}
{#        "PARSE_ERROR"#}
{#    ), default="WAITING_GC")#}

    {% if replay.state == "parsed" %}
        <div class="alert alert-info">PARSED!</div>
    {% elif replay.state in ["WAITING_GC", "WAITING_DOWNLOAD", "DOWNLOAD_IN_PROGRESS", "WAITING_PARSE", "PARSE_IN_PROGRESS"] %}
        {% if replay.state == "WAITING_DOWNLOAD" and replay.replay_state != "REPLAY_AVAILABLE" %}
            <div class="alert alert-danger"><strong>Welp.</strong> The replay is not available ({{ replay.replay_state }}), we can't do anything special with it. :(</div>
        {% else %}
            <div class="alert alert-warning"><strong>I'm not ready!</strong> The replay is in limbo ({{ replay.state }}), check back soon.</div>
        {% endif %}
    {% elif replay.state in ["GC_ERROR", "PARSE_ERROR"] %}
        <div class="alert alert-danger">
            <strong>Sorry!</strong>
            {% if replay.state == "GC_ERROR" %}
                There was a problem retrieving match details, this could be because the match was private, requires a tournament pass to access, or the match id is invalid.
            {% else %}
                There was a problem parsing this matches' replay; it has been reported to the site admins to investigate.
            {% endif %}
        </div>
    {% endif %}

    <div class="tab-pane active" id="overview">
        <dl class="dl-horizontal">
            <dt>id</dt>
            <dd>{{ replay.id }}</dd>
            <dt>url</dt>
            <dd>{{ replay.url }}</dd>
            <dt>state</dt>
            <dd>{{ replay.state }}</dd>
            <dt>replay_state</dt>
            <dd>{{ replay.replay_state }}</dd>
            <dt>ratings</dt>
            <dd>{{ replay.ratings }}</dd>
        </dl>
    </div>
{% endblock %}
