{% extends "layout.html" %}

{% block content %}
    <div class="jumbotron">
        <div class="container">
            <div class="row">
                <div class="col-sm-6">
                    <p>
                        Dotabank archives replays of your Dota 2 matches. Valve can't keep replays for every match ever
                        played available to download, Dotabank can - by only downloading and storing matches which users
                        request, and we keep them available to download for free, forever!
                    </p>
                </div>
                <div class="col-sm-6">
                    <ul>
                        <li>Easy replay archiving - just input a match id</li>
                        <li>Unlimited & fast downloads</li>
                        <li>Automatically archive matches <sup><span class="label label-premium">Premium</span></sup></li>
                        <li>Other features coming soonâ€¦ <sup><span class="label label-premium">Premium</span></sup></li>
                    </ul>
                </div>
            </div>

            <hr>

            <div class="row">
                <div class="col-sm-8 col-sm-offset-2">
                    <form method="POST" action="{{ url_for('replays.search') }}">
                        {{ search_form.hidden_tag() }}
                        <div class="input-group input-group-lg">
                            {{ search_form.query(class='form-control', placeholder='Match ID') }}
                            <span class="input-group-btn">
                                <input type="submit" class="btn btn-primary" value="Archive"/>
                            </span>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6">
            <h1>Latest added</h1>
            <table class="table table-condensed table-striped">
                <thead>
                    <tr>
                        <td>Replay ID</td>
                        <td>State</td>
                        <td>Time</td>
                    </tr>
                </thead>
                <tbody>
                    {% for replay in last_added_replays %}
                        <tr>
                            <td><a href="{{ url_for("replays.replay", _id=replay.id) }}">{{ replay.id }}</a></td>
                            <td>{{ replay.state }}</td>
                            <td>{{ replay.added_to_site_time|datetime_to_datestring }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-sm-6">
            <h1>Latest archived</h1>
            <table class="table table-condensed table-striped">
                <thead>
                    <tr>
                        <td>Replay ID</td>
                        <td>State</td>
                        <td>Time</td>
                    </tr>
                </thead>
                <tbody>
                    {% for replay in last_archived_replays %}
                        <tr>
                            <td><a href="{{ url_for("replays.replay", _id=replay.id) }}">{{ replay.id }}</a></td>
                            <td>{{ replay.state }}</td>
                            <td>{{ replay.dl_done_time|datetime_to_datestring }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="stats">
        <h2>Stats</h2>

        <table class="table">
            <thead>
            <tr>
                <th></th>
                <th>Last 24hrs</th>
                <th>Last Week</th>
                <th>Last Month</th>
                <th>All Time</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th>Replays added</th>
                <td>{{ stats['day']['replays'] }}</td>
                <td>{{ stats['week']['replays'] }}</td>
                <td>{{ stats['month']['replays'] }}</td>
                <td>{{ stats['total']['replays'] }}</td>
            </tr>
            <tr>
                <th>Replays archived</th>
                <td>{{ stats['day']['archived'] }}</td>
                <td>{{ stats['week']['archived'] }}</td>
                <td>{{ stats['month']['archived'] }}</td>
                <td>{{ stats['total']['archived'] }}</td>
            </tr>
            <tr>
                <th>Users registered</th>
                <td>{{ stats['day']['users'] }}</td>
                <td>{{ stats['week']['users'] }}</td>
                <td>{{ stats['month']['users'] }}</td>
                <td>{{ stats['total']['users'] }}</td>
            </tr>
            <tr>
                <th>Downloads fulfilled</th>
                <td>{{ stats['day']['downloads'] }}</td>
                <td>{{ stats['week']['downloads'] }}</td>
                <td>{{ stats['month']['downloads'] }}</td>
                <td>{{ stats['total']['downloads'] }}</td>
            </tr>
            </tbody>
        </table>
    </div>
{% endblock %}
